

select * from nih.PIID_ProfilesID; --1355

select count(*) from [grant] where xml2 is not null;

--with http://www.w3.org/2001/XMLSchema-instance
WITH XMLNAMESPACES ('http://www.w3.org/2001/XMLSchema-instance' as pd)
select top 10 g.[xml].value('(//pd:APPLICATION_ID)[1]', 'varchar'), * from [grant] g;

select top 10 g.[xml].value('(//TOTAL_COST)[1]', 'int'), * from [grant] g;

update g set g.TOTAL_COST = g.[xml].value('(//TOTAL_COST)[1]', 'int') from [grant] g;

select top 10 * from [grant]
data;

update g set g.xml2 = cast(g.[xml] as xml) from [grant] g;

select p.DisplayName, p.internalusername, g.TOTAL_COST, g.FY, fullprojectnum, projecttitle, icname, orgname, orgdept
from nih.PIID_ProfilesID a join PrincipalInvestigator b on 
cast(a.PIID as int) = b.PrincipalInvestigator_ID join grantprincipal gp on gp.principalinvestigatorid 
= b.principalinvestigatorid join [grant] g on gp.grantid = g.grantid
join person p on p.personid = a.profilesId where p.internalusername in ( --; -- 1355
'020679841',
'029745338',
'027116870',
'029731528',
'022458673',
'022172563',
'021478763',
'022510606',
'025455965',
'024847154',
'023363526',
'027907559',
'026388132',
'020318275',
'028021806',
'029665429',
'025692542',
'025129578',
'025744939',
'022902985',
'020404208',
'026286203',
'025001009',
'020637666',
'028631943',
'023711344',
'028883445',
'025544016',
'021961818',
'023552714',
'022420061',
'020126348',
'022093603',
'027806371',
'024633331',
'025784414',
'020455143',
'021473301',
'020943643',
'024221541',
'029221934',
'025814237',
'028393320',
'025515867',
'028367225',
'023845837',
'024867798',
'028557569',
'029275252',
'027474535',
'027369370',
'029214038',
'021390620',
'022771703',
'023021645',
'026498709',
'023958507',
'027013457',
'022969513',
'025259920',
'023466105',
'028718328',
'027232909',
'023229305',
'025098807',
'023362007',
'029744133',
'029752755',
'023972557',
'025127911',
'025667130',
'024587131',
'029606555',
'022268403',
'027436112',
'029212412',
'029907433',
'024031601',
'023734445',
'027861855',
'026814418',
'020373007',
'021763867',
'027244292',
'027515659',
'026077875',
'020888657',
'025664202',
'023653496',
'024271660',
'025236464',
'027979210',
'023251820',
'028701811',
'020873949',
'020821534',
'029899663',
'023219165',
'028439107',
'024954570',
'027532381',
'024036261',
'024659757',
'028792372',
'025076761',
'020790234',
'026749622',
'024277493',
'025569856',
'028762862',
'022435127',
'026687392',
'021111281',
'025928847',
'022674543',
'022124192',
'025309659',
'021300900',
'022310221',
'021763321',
'022491229',
'026935338',
'029269842',
'022269898',
'020049151',
'029571247',
'026690826',
'024448763',
'025963893',
'026969501',
'024186272',
'024220139',
'026262154',
'026354977',
'022670186',
'028826113',
'026152074',
'024515397',
'021370101',
'023850001',
'025568809',
'023305741',
'026694067',
'025356486',
'023040074',
'028784361',
'025272378',
'024843401',
'025551011',
'023038797',
'022014732',
'025975004',
'027885078',
'029513207',
'027962885',
'029418456',
'021825187',
'023774219',
'025233339',
'027711688',
'026820472',
'020362802',
'027329887',
'021525472',
'027532407',
'028428456',
'028403970',
'024082414',
'028108496',
'025597006',
'027532225',
'025890245',
'021272919',
'028539930',
'024374233',
'020770608',
'027053222',
'021365598',
'022653562',
'022754816',
'027510460',
'024798126',
'024272262',
'025296641',
'026147413',
'025387606',
'029052263',
'020652327',
'020535811',
'022632962',
'023681000',
'020049086',
'023196090',
'021285556',
'029124559',
'022936298')
order by p.DisplayName;

select * from 

<row>    <APPLICATION_ID>7391545</APPLICATION_ID>    <ACTIVITY>R01</ACTIVITY>    <ADMINISTERING_IC>HL</ADMINISTERING_IC>    <APPLICATION_TYPE>5</APPLICATION_TYPE>    <ARRA_FUNDED p2:nil="true" xmlns:p2="http://www.w3.org/2001/XMLSchema-instance" />    <BUDGET_START>04/01/2008</BUDGET_START>    <BUDGET_END>03/31/2009</BUDGET_END>    <FOA_NUMBER p2:nil="true" xmlns:p2="http://www.w3.org/2001/XMLSchema-instance" />    <FULL_PROJECT_NUM>5R01HL075033-04</FULL_PROJECT_NUM>    <FUNDING_ICs>NHLBI:359123\</FUNDING_ICs>    <FY>2008</FY>    <NIH_SPENDING_CATS>  <CATEGORY>Genetics</CATEGORY>  </NIH_SPENDING_CATS>    <ORG_CITY>SAN FRANCISCO</ORG_CITY>    <ORG_COUNTRY>UNITED STATES</ORG_COUNTRY>    <ORG_DISTRICT>12</ORG_DISTRICT>    <ORG_DUNS>073133571</ORG_DUNS>    <ORG_DEPT>SURGERY</ORG_DEPT>    <ORG_FIPS>US</ORG_FIPS>    <ORG_STATE>CA</ORG_STATE>    <ORG_ZIPCODE>941430962</ORG_ZIPCODE>    <IC_NAME>NATIONAL HEART, LUNG, AND BLOOD INSTITUTE</IC_NAME>    <ORG_NAME>UNIVERSITY OF CALIFORNIA SAN FRANCISCO</ORG_NAME>    <PIS>  <PI>  <PI_NAME>WANG, RONG </PI_NAME>  <PI_ID>7597309</PI_ID>  </PI>  </PIS>    <PROJECT_TERMS>  <TERM>2-Naphthacenecarboxamide, 4-(dimethylamino)-1,4,4a,5,5a,6,11,12a-octahydro-3,6,10,12,12a-pentahydroxy-6-methyl-1,11-dioxo-, (4S-(4alpha,4aalpha,5aalpha,6beta,12aalpha))-</TERM>  <TERM>21+ years old</TERM>  <TERM>Achromycin</TERM>  <TERM>Adult</TERM>  <TERM>Angioblast</TERM>  <TERM>Aorta</TERM>  <TERM>Arteries</TERM>  <TERM>Arteriogram</TERM>  <TERM>Biologic Marker</TERM>  <TERM>Biological</TERM>  <TERM>Biological Markers</TERM>  <TERM>Blood Circulation</TERM>  <TERM>Blood Vessels</TERM>  <TERM>Blood flow</TERM>  <TERM>Bloodstream</TERM>  <TERM>Brachydanio rerio</TERM>  <TERM>Candidate Disease Gene</TERM>  <TERM>Candidate Gene</TERM>  <TERM>Cardinal vein</TERM>  <TERM>Cell Adhesion</TERM>  <TERM>Cell Communication</TERM>  <TERM>Cell Communication and Signaling</TERM>  <TERM>Cell Growth in Number</TERM>  <TERM>Cell Interaction</TERM>  <TERM>Cell Isolation</TERM>  <TERM>Cell Multiplication</TERM>  <TERM>Cell Proliferation</TERM>  <TERM>Cell Segregation</TERM>  <TERM>Cell Separation</TERM>  <TERM>Cell Separation Technology</TERM>  <TERM>Cell Signaling</TERM>  <TERM>Cell Survival</TERM>  <TERM>Cell Viability</TERM>  <TERM>Cell-to-Cell Interaction</TERM>  <TERM>Cells</TERM>  <TERM>Cellular Adhesion</TERM>  <TERM>Cellular Proliferation</TERM>  <TERM>Cessation of life</TERM>  <TERM>Circulation</TERM>  <TERM>Complex</TERM>  <TERM>Condition</TERM>  <TERM>DISSEC</TERM>  <TERM>Danio rerio</TERM>  <TERM>Death</TERM>  <TERM>Defect</TERM>  <TERM>Development</TERM>  <TERM>Dissection</TERM>  <TERM>Dorsal</TERM>  <TERM>Down-Regulation</TERM>  <TERM>Down-Regulation (Physiology)</TERM>  <TERM>Downregulation</TERM>  <TERM>Drug Delivery</TERM>  <TERM>Drug Delivery Systems</TERM>  <TERM>Drug Targeting</TERM>  <TERM>Drug Targetings</TERM>  <TERM>EPHB4 Protein</TERM>  <TERM>Embryo</TERM>  <TERM>Embryonic</TERM>  <TERM>Endothelial Cells</TERM>  <TERM>Endothelium</TERM>  <TERM>EphB4 Receptor</TERM>  <TERM>Equilibrium</TERM>  <TERM>Event</TERM>  <TERM>Feedback</TERM>  <TERM>Future</TERM>  <TERM>Gene Expression</TERM>  <TERM>Genes</TERM>  <TERM>Genetic</TERM>  <TERM>Goals</TERM>  <TERM>Hepatoma Transmembrane Kinase</TERM>  <TERM>Human, Adult</TERM>  <TERM>Image</TERM>  <TERM>Intracellular Communication and Signaling</TERM>  <TERM>Investigation</TERM>  <TERM>Investigators</TERM>  <TERM>Knockout Mice</TERM>  <TERM>Lead</TERM>  <TERM>Leiomyocyte</TERM>  <TERM>Lesion</TERM>  <TERM>Link</TERM>  <TERM>Liver</TERM>  <TERM>Lung</TERM>  <TERM>Maintenance</TERM>  <TERM>Maintenances</TERM>  <TERM>Mammals, Mice</TERM>  <TERM>Methods</TERM>  <TERM>Methods and Techniques</TERM>  <TERM>Methods, Other</TERM>  <TERM>Mice</TERM>  <TERM>Mice, Knock-out</TERM>  <TERM>Mice, Knockout</TERM>  <TERM>Mice, Transgenic</TERM>  <TERM>Modeling</TERM>  <TERM>Molecular</TERM>  <TERM>Molecular Marker</TERM>  <TERM>Molecular Probes</TERM>  <TERM>Morphogenesis</TERM>  <TERM>Murine</TERM>  <TERM>Mus</TERM>  <TERM>Myocytes, Smooth Muscle</TERM>  <TERM>Null Mouse</TERM>  <TERM>Pathogenesis</TERM>  <TERM>Pathway interactions</TERM>  <TERM>Pattern</TERM>  <TERM>Pb element</TERM>  <TERM>Phenotype</TERM>  <TERM>Pressure</TERM>  <TERM>Pressure- physical agent</TERM>  <TERM>Process</TERM>  <TERM>Programs (PT)</TERM>  <TERM>Programs [Publication Type]</TERM>  <TERM>Receptor, EphB4</TERM>  <TERM>Regulation</TERM>  <TERM>Research Personnel</TERM>  <TERM>Researchers</TERM>  <TERM>Respiratory System, Lung</TERM>  <TERM>Role</TERM>  <TERM>Seminal</TERM>  <TERM>Signal Transduction</TERM>  <TERM>Signal Transduction Systems</TERM>  <TERM>Signaling</TERM>  <TERM>Signature Molecule</TERM>  <TERM>Smooth Muscle Cells</TERM>  <TERM>Smooth Muscle Myocytes</TERM>  <TERM>Smooth Muscle Tissue Cell</TERM>  <TERM>Specific qualifier value</TERM>  <TERM>Specified</TERM>  <TERM>Staging</TERM>  <TERM>TCN</TERM>  <TERM>Techniques</TERM>  <TERM>Testing</TERM>  <TERM>Tet</TERM>  <TERM>Tetanus Helper Peptide</TERM>  <TERM>Tetracycline</TERM>  <TERM>Tetracycline Antibiotic</TERM>  <TERM>Tetracyclines</TERM>  <TERM>Therapeutic Intervention</TERM>  <TERM>Time</TERM>  <TERM>Transgenes</TERM>  <TERM>Transgenic Mice</TERM>  <TERM>Up-Regulation</TERM>  <TERM>Up-Regulation (Physiology)</TERM>  <TERM>Upregulation</TERM>  <TERM>Vascular Diseases</TERM>  <TERM>Vascular Disorder</TERM>  <TERM>Veins</TERM>  <TERM>Venous</TERM>  <TERM>Work</TERM>  <TERM>Yolk Sac</TERM>  <TERM>Zebra Danio</TERM>  <TERM>Zebra Fish</TERM>  <TERM>Zebrafish</TERM>  <TERM>adult human (21+)</TERM>  <TERM>arterial imaging</TERM>  <TERM>balance</TERM>  <TERM>balance function</TERM>  <TERM>biological signal transduction</TERM>  <TERM>biomarker</TERM>  <TERM>blood vessel disorder</TERM>  <TERM>body system, hepatic</TERM>  <TERM>cell sorting</TERM>  <TERM>cell type</TERM>  <TERM>embryo culture</TERM>  <TERM>experiment</TERM>  <TERM>experimental research</TERM>  <TERM>experimental study</TERM>  <TERM>gene function</TERM>  <TERM>heavy metal Pb</TERM>  <TERM>heavy metal lead</TERM>  <TERM>imaging</TERM>  <TERM>interest</TERM>  <TERM>intervention therapy</TERM>  <TERM>loss of function</TERM>  <TERM>member</TERM>  <TERM>mouse model</TERM>  <TERM>mutant</TERM>  <TERM>notch</TERM>  <TERM>notch protein</TERM>  <TERM>notch receptors</TERM>  <TERM>novel</TERM>  <TERM>organ system, hepatic</TERM>  <TERM>pathway</TERM>  <TERM>postnatal</TERM>  <TERM>prenatal</TERM>  <TERM>pressure</TERM>  <TERM>programs</TERM>  <TERM>pulmonary</TERM>  <TERM>research study</TERM>  <TERM>social role</TERM>  <TERM>transgene expression</TERM>  <TERM>unborn</TERM>  <TERM>vascular</TERM>  <TERM>vitelline sac</TERM>  </PROJECT_TERMS>    <PROJECT_TITLE>Notch Signaling in Mouse Arterial-Venous Specification</PROJECT_TITLE>    <PROJECT_START>04/01/2005</PROJECT_START>    <PROJECT_END>03/31/2010</PROJECT_END>    <PHR p2:nil="true" xmlns:p2="http://www.w3.org/2001/XMLSchema-instance" />    <SERIAL_NUMBER>75033</SERIAL_NUMBER>    <STUDY_SECTION>ZRG1</STUDY_SECTION>    <STUDY_SECTION_NAME>Special Emphasis Panel</STUDY_SECTION_NAME>    <SUPPORT_YEAR>4</SUPPORT_YEAR>    <SUFFIX p2:nil="true" xmlns:p2="http://www.w3.org/2001/XMLSchema-instance" />    <SUBPROJECT_ID p2:nil="true" xmlns:p2="http://www.w3.org/2001/XMLSchema-instance" />    <TOTAL_COST>359123</TOTAL_COST>    <TOTAL_COST_SUB_PROJECT p2:nil="true" xmlns:p2="http://www.w3.org/2001/XMLSchema-instance" />    <CORE_PROJECT_NUM>R01HL075033</CORE_PROJECT_NUM>    <CFDA_CODE>837</CFDA_CODE>    <PROGRAM_OFFICER_NAME>SRINIVAS, POTHUR R</PROGRAM_OFFICER_NAME>    <ED_INST_TYPE>SCHOOLS OF MEDICINE</ED_INST_TYPE>    <AWARD_NOTICE_DATE>2008-03-14</AWARD_NOTICE_DATE>  </row>

select *  from shindig_appdata where appid = 108 and userId = 5258671
keyname = 'nih_n';

--delete from  shindig_appdata where appid = 108;

exec [sp_Create_shinding_appdata];

--insert into shindig_appdata
--select distinct userid, 108, 'VISIBLE', 'Y', getdate(), getdate() from  shindig_appdata where appid = 108;

select top 10 * from [grant];